test generation
generateAbnormalResolverTests
	"Test resolving abnormal relative URI references to absolute URIs."
	"Originally snagged from mir's TestURI class."
	"self generateAbnormalResolverTests"

	| relURIString result method testPairs pair |

	testPairs _ #(
		"2396 actually says '(current document)'; I think this is what it meant by that."
		(''	'')

		('../../../g' 'http://a/../g')
		('../../../../g' 'http://a/../../g')
		('/./g' 'http://a/./g')
		('/../g' 'http://a/../g')
		('g.' 'http://a/b/c/g.')
		('.g' 'http://a/b/c/.g')
		('g..' 'http://a/b/c/g..')
		('..g' 'http://a/b/c/..g')
		('./../g' 'http://a/b/g')
		('./g/.' 'http://a/b/c/g/')
		('g/./h' 'http://a/b/c/g/h')
		('g/../h' 'http://a/b/c/h')
		('g;x=1/./y' 'http://a/b/c/g;x=1/y')
		('g;x=1/../y' 'http://a/b/c/y')
		('g?y/./x' 'http://a/b/c/g?y/./x')
		('g?y/../x' 'http://a/b/c/g?y/../x')
		('g#s/./x' 'http://a/b/c/g#s/./x')
		('g#s/../x' 'http://a/b/c/g#s/../x')

		"2396 says this result is correct for validating parsers; for backwards compatibility, this result would be 'http://a/b/c/g'."
      	('http:g' 'http:g')).

	1
		to: testPairs size
		do: [:index |
			pair _ testPairs at: index.
			relURIString _ pair first.
			result _ pair last.
			method _ String streamContents: [:stream |
				stream
					nextPutAll: 'test2396ResolveAbnormal' , index printString; 
					cr;
					nextPutAll: '	"From section C.2."';
					cr;
					nextPutAll: '	"Automatically generated by class>>generateAbormalResolverTests; do not edit here."';
					cr;
					cr;		
					nextPutAll: '	| baseURI relURI resolvedURI |';
					cr;
					cr;
					nextPutAll: '	baseURI _ URI fromString: ''http://a/b/c/d;p?q''.';
					cr;
					nextPutAll: '	relURI _ URI fromString: ''';
					nextPutAll: relURIString;
					nextPutAll: '''.';
					cr;
					nextPutAll: '	resolvedURI _ baseURI resolveRelativeURI: relURI.';
					cr;
					cr;
					nextPutAll: '	self should: [resolvedURI asString = '''; 
					nextPutAll: result;
					nextPutAll: ''']'].

		self compile: method classified: 'examples']