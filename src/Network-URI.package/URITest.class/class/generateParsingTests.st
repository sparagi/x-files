test generation
generateParsingTests
	"Generate tests that parse example URIs."
	"self generateParsingTests"
	| validURIs |

	validURIs := #(
		"From RFC 3986 section 1.1.2."
		'ftp://ftp.is.co.za/rfc/rfc1808.txt'
		'http://www.ietf.org/rfc/rfc2396.txt'
		'ldap://[2001:db8::7]/c=GB?objectClass?one'
		'mailto:John.Doe@example.com'
		'news:comp.infosystems.www.servers.unix'
		'tel:+1-816-555-1212'
		'telnet://192.0.2.16:80/'
		'urn:oasis:names:specification:docbook:dtd:xml:4.1.2').

	1 to: validURIs size do: [:testNumber | | testURI testMethod |
		testURI := validURIs at: testNumber.
		testMethod := String streamContents: [:stream |stream
			nextPutAll: 'test3986Parse'; nextPutAll: testNumber asString; cr;
			nextPutAll: '	"From section 1.1.2."'; cr;
			nextPutAll: '	"Automatically generated by class>>generateParsingTests; do not edit here."'; cr;		
			nextPutAll: '	| uriString uriObject |'; cr;
			cr;
			nextPutAll: '	uriString := '''; nextPutAll: testURI; nextPutAll: '''.'; cr;
			nextPutAll: '	uriObject := URI fromString: uriString.'; cr;
			cr;
			nextPutAll: '	self should: [uriObject asString = uriString]'; cr]. 
		self compile: testMethod classified: 'examples']